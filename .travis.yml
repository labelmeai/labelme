sudo: false

cache: pip

matrix:
  include:
    - os: linux
      dist: trusty
      language: python
      env:
        - PYTHON=/usr/bin/python
      addons:
        apt:
          packages:
            - gfortran
            - liblapack-dev
            - pyqt4-dev-tools
            - python-qt4
      before_install:
        - cp -r $(dirname $($PYTHON -c 'import PyQt4; print(PyQt4.__file__)')) ~/virtualenv/python2.7/lib/python2.7/site-packages/
        - cp $($PYTHON -c 'import sip; print(sip.__file__)') ~/virtualenv/python2.7/lib/python2.7/site-packages/
    - os: osx
      osx_image: xcode9
      language: generic
      env:
        - PYTHON=/usr/local/opt/python/libexec/bin/python
        - PIP=/usr/local/opt/python/libexec/bin/pip
      before_install:
        - brew install pyqt
        - $PIP install virtualenv
        - virtualenv ~/virtualenv/python2.7
        - source ~/virtualenv/python2.7/bin/activate
        - cp -r $(dirname $($PYTHON -c 'import PyQt5; print(PyQt5.__file__)')) ~/virtualenv/python2.7/lib/python2.7/site-packages/
        - cp $($PYTHON -c 'import sip; print(sip.__file__)') ~/virtualenv/python2.7/lib/python2.7/site-packages/

install:
  - pip install -U pip setuptools
  - pip install -U numpy  # for scikit-image
  - python setup.py install

before_script:
  - pip install nose

script:
  - nosetests tests
